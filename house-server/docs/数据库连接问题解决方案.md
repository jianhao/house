# 数据库连接问题解决方案

## 问题描述

在使用 Navicat Premium 连接 PostgreSQL 数据库时出现以下错误：
```
ERROR: column "datlastsysoid" does not exist
LINE 1: SELECT DISTINCT datlastsysoid FROM pg_database
```

## 问题原因

这个错误是由于 **Navicat 版本过旧** 导致的兼容性问题：

1. 项目使用的是 **PostgreSQL 15.4** 版本
2. `datlastsysoid` 列在 PostgreSQL 12+ 版本中已被移除
3. 旧版本的 Navicat 仍然尝试查询这个不存在的列

## 解决方案

### 方案一：升级 Navicat（推荐）

1. **升级到最新版本**
   - 下载并安装最新版本的 Navicat Premium
   - 确保版本支持 PostgreSQL 15+

2. **重新配置连接**
   - 删除旧的连接配置
   - 重新创建连接，使用以下参数：
     ```
     主机: localhost
     端口: 5432
     数据库: house_db
     用户名: postgres
     密码: password
     ```

### 方案二：使用 Adminer（已配置好）

项目已经配置了 Adminer 作为数据库管理工具：

1. **访问地址**: http://localhost:8080
2. **登录信息**:
   ```
   系统: PostgreSQL
   服务器: postgres
   用户名: postgres
   密码: password
   数据库: house_db
   ```

### 方案三：使用命令行工具

```bash
# 进入数据库容器
docker exec -it house-postgres psql -U postgres -d house_db

# 查看所有表
\dt

# 查看表结构
\d table_name

# 执行 SQL 查询
SELECT * FROM houses LIMIT 5;
```

### 方案四：使用其他数据库客户端

推荐的替代工具：

1. **pgAdmin 4**（免费）
   - 官方推荐的 PostgreSQL 管理工具
   - 完全支持 PostgreSQL 15+

2. **DBeaver**（免费）
   - 通用数据库管理工具
   - 支持多种数据库类型

3. **DataGrip**（付费）
   - JetBrains 出品的专业数据库工具
   - 功能强大，支持所有主流数据库

## 验证连接

连接成功后，可以执行以下查询验证：

```sql
-- 查看数据库版本
SELECT version();

-- 查看所有表
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public';

-- 查看房源数据
SELECT id, title, price, area FROM houses LIMIT 5;
```

## 注意事项

1. **确保 Docker 服务正在运行**
   ```bash
   docker ps | grep postgres
   ```

2. **检查端口占用**
   - 确保 5432 端口没有被其他服务占用
   - 如有冲突，可以修改 docker-compose.yml 中的端口映射

3. **防火墙设置**
   - 确保本地防火墙允许 5432 端口访问

## 推荐配置

为了获得最佳体验，建议：

1. **开发环境**: 使用 Adminer (http://localhost:8080)
2. **生产管理**: 升级 Navicat 或使用 pgAdmin 4
3. **快速查询**: 使用命令行工具

## 联系支持

如果问题仍然存在，请提供：
1. Navicat 版本信息
2. 操作系统版本
3. 完整的错误日志